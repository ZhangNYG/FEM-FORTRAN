C	MASTER TEMPERATURE
	REAL K0,K,NF
	INTEGER E,E1,E2,A,B,S,A0,A1,A2,TI,AB,E0
	LOGICAL AAA
	DIMENSION K(2000),N(300),K0(300),X(200),R(300),P(300)
     1,I(500),J(500),M(600),AL(200),TI(200),TL(30),T00(30)
	1,MB(20),AL0(20),AT0(20),KEY(2),MA(20),DQ(500),DQ0(500),G(500)
	COMMON X,R,P,K,C
c	************************************************
c	输入控制变量key
	OPEN(1,FILE='dat.txt')
	OPEN(4,FILE='DAT1.txt',STATUS='NEW')
	READ(1,5)KEY
C	如果key（1）=0 则计算轴对称恒定温度场，否则计算平面稳定温度场
	
	
	IF(KEY(1).EQ.0) WRITE(4,106)KEY(1),KEY(2)
	IF(KEY(1).NE.0) WRITE(4,110)KEY(1),KEY(2)
	
C	输入和刷出初始数据
	
	READ(1,8)L0,L01,E1,E2,A0,B,H,C
	READ(1,1111)(X(L),L=1,L0)
	READ(1,1111)(R(L),L=1,L0)
	READ(1,2222)(I(E),E=1,E2)
	READ(1,2222)(J(E),E=1,E2)
	READ(1,2222)(M(E),E=1,E2)
	
	
	WRITE(4,1112)L0,L01,E1,E2,A0,B,H,C
	WRITE(4,1113)(L,X(L),R(L),L=1,L0)
	WRITE(4,2200)(E,I(E),J(E),M(E),E=1,E2)
5	FORMAT(2I5)
106	FORMAT(15X,'* AXIS TEMPERATURE FIELD *'///,I5,I5)
110	FORMAT(15X,'* PLANE TEMPERATURE FILED *'///,I5,I5)
8	FORMAT(6I4,2F10.4)
1111	FORMAT(10F8.2)
2222	FORMAT(10I7)
1112	FORMAT(1X,'L0=',I2,5X,'L01=',I2,5X,'E1=',I2,5X,'E2=
     1',I2,5X,'A0=',I2,5X,'B=',I2,5X,'H=',F10.3,5X,'C=',F5.3)
1113	FORMAT(I10,2F10.3)
2200	FORMAT(4I15)
1114	FORMAT(8I4/8F8.1)
11	FORMAT(30I4/30F10.2)
1115	FORMAT((8I4)/(8F10.4)/(8F10.4))
12	FORMAT(20I4/20F8.1/20F10.4)
30	FORMAT(///10X,2HS=,I5///)
222	FORMAT(10X,2HE,I5)
121	FORMAT(/10X,'TEMPERATURE OF NODAL POINTS'//(8F8.2))
131	FORMAT(3F10.3,I10)
132	FORMAT(20I4)
300	FORMAT(///10X,'NF=',F10.2///(I,F8.2)///(I,F8.2))
820	FORMAT(///10X,'T=',F10.2/3X,'E',10X,'X',10X,'R',/(3F10.3))
	CLOSE(1)
	CLOSE(4)
	END